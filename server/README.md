# Сервер myRPC

myRPC-server — демон, который принимает удалённые команды от клиентов myRPC-client, проверяет разрешённость пользователя и выполняет команду в системе. Поддерживает работу через TCP и UDP сокеты и использует JSON-протокол обмена сообщениями.

## ⚙️ Компиляция

Для сборки сервера:

```bash
make -C server
```

Или из текущей папки:
```
make
```

**Настройка**
Перед запуском убедитесь, что настроены:

**Файл конфигурации /etc/myRPC/myRPC.conf:**
```
port = 1234
socket_type = stream
```

**Список разрешённых пользователей /etc/myRPC/users.conf:**

astraadmin 

**Запуск**
```
sudo ./myRPC-server
```

После запуска сервер слушает указанный в конфигурации порт и принимает JSON-запросы от клиентов.

**Формат запроса от клиента**
```
{
  "login": "имя_пользователя",
  "command": "bash-команда"
}
```

**Формат ответа сервера**
```
{
  "code": 0, // 0 — успех, 1 — ошибка
  "result": "Результат выполнения или описание ошибки"
}
```

**Вывод команды**

Результат stdout и stderr временно сохраняется в файлах /tmp/myRPC_XXXXXX.stdout и .stderr, после чего удаляется.

**Логи**

Все события сервера записываются через libmysyslog в /var/log/myrpc-server.log


**Зависимости**

libjson-c (устанавливается через sudo apt install libjson-c-dev)


**Важно**

Запуск требует прав суперпользователя (для открытия порта и чтения конфигураций).

При ошибках проверьте наличие и права на чтение файлов /etc/myRPC/myRPC.conf и /etc/myRPC/users.conf.


**Пример запуска**
```
sudo ./myRPC-server
```
